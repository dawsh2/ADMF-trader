# Regime-Aware Ensemble Strategy

This README provides an overview of the Regime-Aware Ensemble Strategy implementation for the ADMF-Trader framework.

## Strategy Overview

The Regime-Aware Ensemble Strategy is an advanced trading strategy that:

1. **Detects Market Regimes**: Identifies different market environments (trending, mean-reverting, volatile, neutral)
2. **Combines Multiple Trading Rules**: Implements trend following, mean reversion, and volatility breakout strategies
3. **Adapts Rule Weights**: Dynamically adjusts the importance of each rule based on the detected market regime

This approach aims to create a strategy that can adapt to changing market conditions, rather than being optimized for just one type of market environment.

## Components

### 1. Regime Detection

The strategy detects four distinct market regimes:

- **Trending**: Strong directional movement with sustained momentum
- **Mean-Reverting**: Price oscillating around a central value
- **Volatile**: High volatility with unpredictable price swings
- **Neutral**: No clear pattern, random-walk behavior

Regime detection uses metrics including:
- Price relative to moving average
- Recent volatility level (standard deviation of returns)
- Directionality of recent price movement

### 2. Trading Rules

Three distinct trading rules are implemented:

- **Trend Following (MA Crossover)**: Generates signals based on fast and slow moving average crossovers
- **Mean Reversion (RSI)**: Uses RSI (Relative Strength Index) to identify overbought/oversold conditions
- **Volatility Breakout**: Identifies breakouts from recent price channels scaled by ATR (Average True Range)

Each rule produces a signal value between -1.0 (strong sell) and 1.0 (strong buy).

### 3. Adaptive Weighting

The strategy adjusts the weights of each rule based on the detected regime:

- In **Trending** regimes: Higher weight to trend following rules
- In **Mean-Reverting** regimes: Higher weight to mean reversion rules
- In **Volatile** regimes: Higher weight to volatility breakout rules
- In **Neutral** regimes: Equal weights to all rules

## Usage

### Running the Strategy

To run the strategy with synthetic data:

```bash
# Generate multi-regime test data and run backtest
python run_regime_ensemble.py --generate-data --plot-data

# Run on existing data
python run_regime_ensemble.py
```

### Configuration

The strategy can be configured via the `config/regime_ensemble.yaml` file:

```yaml
strategies:
  regime_ensemble:
    # Regime detection parameters
    volatility_window: 20
    volatility_threshold: 0.015
    trend_ma_window: 50
    trend_threshold: 0.05
    
    # Trading rule parameters
    fast_ma_window: 10
    slow_ma_window: 30
    rsi_window: 14
    rsi_overbought: 70
    rsi_oversold: 30
    breakout_window: 20
    breakout_multiplier: 2.0
    
    # Rule weights for each regime
    regime_weights:
      trend:
        trend_following: 1.0
        mean_reversion: 0.2
        volatility_breakout: 0.5
      # ... other regimes
```

## Implementation Details

### Regime Detection Logic

Market regimes are detected using the following logic:

```python
if volatility > volatility_threshold:
    # High volatility indicates volatile regime
    regime = MarketRegime.VOLATILE
elif abs(trend_diff_pct) > trend_threshold:
    # Strong trend in consistent direction
    regime = MarketRegime.TREND
elif abs(trend_diff_pct) < trend_threshold * 0.5:
    # Price near moving average, likely mean-reverting
    regime = MarketRegime.MEAN_REVERSION
else:
    # Default if no clear pattern
    regime = MarketRegime.NEUTRAL
```

### Signal Generation

The final trading signal is generated by:

1. Calculating individual rule signals (-1.0 to 1.0)
2. Applying regime-specific weights
3. Calculating weighted average
4. Thresholding to produce final -1, 0, or 1 signal

## Testing with Synthetic Data

The strategy includes a synthetic data generator (`generate_multi_regime_data.py`) that creates price data exhibiting different market regimes for testing:

- **Trending Up**: Positive drift with noise
- **Trending Down**: Negative drift with noise
- **Mean-Reverting**: Price oscillating around a mean
- **Volatile**: High variance with changing volatility
- **Random**: Random walk (neutral regime)

Each symbol has a different sequence of regimes to test the strategy's adaptability.

## Future Extensions

In future versions, consider:

1. **Machine Learning Regime Detection**: Use ML to identify regimes more accurately
2. **Optimization By Regime**: Separately optimize parameters for each regime
3. **Additional Rules**: Add more trading rules for specific market conditions
4. **Meta-Labeling**: Add a secondary model to filter signals based on probability of success
5. **Time-Based Regime Sensitivity**: Adjust how quickly the strategy adapts to regime changes

## Conclusion

The Regime-Aware Ensemble Strategy demonstrates how the ADMF-Trader framework can be used to build sophisticated, adaptive trading strategies that combine multiple approaches. By detecting market regimes and adapting rule weights, the strategy aims to perform well across different market conditions rather than being optimized for just one environment.
