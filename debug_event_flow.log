2025-04-24 22:55:58,731 - INFO - [DebugFlow] - Debug script starting
2025-04-24 22:55:58,731 - INFO - [DebugFlow] - === Starting Event Flow Debug ===
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for FILL
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for BAR
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for ORDER
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for ORDER
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for FILL
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for SIGNAL
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for SIGNAL
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for ORDER
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for ORDER
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for FILL
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for FILL
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for BAR
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for SIGNAL
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for ORDER
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for FILL
2025-04-24 22:55:58,731 - DEBUG - [src.core.events.event_bus] - Registered handler for POSITION
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for PORTFOLIO
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for STRATEGY
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for METRIC
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for WEBSOCKET
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for LIFECYCLE
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for ERROR
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for OPTIMIZATION
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for FILTER
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Registered handler for REGIME
2025-04-24 22:55:58,732 - INFO - [DebugFlow] - Injecting first signal (BUY)
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - EVENT_EMIT: SIGNAL #1 for AAPL value=1
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Emitting SIGNAL event (ID: 78034d2a-e6c1-41c1-b26b-220979456fa5)
2025-04-24 22:55:58,732 - DEBUG - [src.risk.managers.simple] - Processing signal: 1 for AAPL at 100.00
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - EVENT_EMIT: ORDER #1 BUY 100 AAPL @ 100.0
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Emitting ORDER event (ID: 0665634c-f78b-4ff1-b798-89f8c9689582)
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: SimulatedBroker.process_order START
2025-04-24 22:55:58,732 - INFO - [src.execution.broker.broker_simulator] - Broker processed order: BUY 100 AAPL @ 100.00
2025-04-24 22:55:58,732 - INFO - [src.execution.broker.broker_simulator] - Broker emitting fill event for AAPL
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: SimulatedBroker.process_order END
2025-04-24 22:55:58,732 - INFO - [src.execution.broker.broker_simulator] - Broker emitting fill event for AAPL
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - EVENT_EMIT: FILL #1 BUY 100 AAPL @ 100.0
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Emitting FILL event (ID: 0a42a3db-a184-4e86-a33f-0c39ef10c6a9)
2025-04-24 22:55:58,732 - DEBUG - [src.risk.portfolio.position] - Updating position AAPL: current=0, change=100, price=100.0
2025-04-24 22:55:58,732 - DEBUG - [src.risk.portfolio.position] - Opening new position: quantity=100, cost_basis=100.0
2025-04-24 22:55:58,732 - INFO - [src.risk.portfolio.portfolio] - Fill: BUY 100 AAPL @ 100.00, PnL: 0.00, Cash: 90000.00, Equity: 100000.00
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - EVENT_EMIT: PORTFOLIO #1
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Emitting PORTFOLIO event (ID: 3dc344eb-7968-4c3e-ab98-0c91eb37a782)
2025-04-24 22:55:58,732 - DEBUG - [src.execution.order_manager] - Found order_id in fill event: b031d18b-f935-40a6-8723-626d62e559eb
2025-04-24 22:55:58,732 - DEBUG - [src.execution.order_manager] - No direct order ID match, trying symbol/direction matching for AAPL/BUY
2025-04-24 22:55:58,732 - WARNING - [src.execution.order_manager] - No matching order found for fill: AAPL BUY
2025-04-24 22:55:58,732 - DEBUG - [src.execution.order_manager] - Found order_id in fill event: b031d18b-f935-40a6-8723-626d62e559eb
2025-04-24 22:55:58,732 - DEBUG - [src.execution.order_manager] - No direct order ID match, trying symbol/direction matching for AAPL/BUY
2025-04-24 22:55:58,732 - WARNING - [src.execution.order_manager] - No matching order found for fill: AAPL BUY
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: PortfolioManager.on_fill START
2025-04-24 22:55:58,732 - DEBUG - [src.risk.portfolio.portfolio] - Fill 0a42a3db-a184-4e86-a33f-0c39ef10c6a9 already processed by portfolio, skipping
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: PortfolioManager.on_fill END
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: SimulatedBroker.process_order START
2025-04-24 22:55:58,732 - DEBUG - [src.execution.broker.broker_simulator] - Order AAPL_BUY_100_b031d18b-f935-40a6-8723-626d62e559eb already processed by broker, skipping
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: SimulatedBroker.process_order END
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - EVENT_EMIT: PORTFOLIO #2
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Emitting PORTFOLIO event (ID: 81c7cdce-f0c8-4b56-8a69-e0d3a584934e)
2025-04-24 22:55:58,732 - INFO - [src.execution.order_manager] - Created order: Order(c9cefc24-0c6e-4507-b4bf-fb25f61af887, AAPL, BUY, 100, PENDING)
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: OrderManager.on_order START
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: SimulatedBroker.process_order START
2025-04-24 22:55:58,732 - DEBUG - [src.execution.broker.broker_simulator] - Order AAPL_BUY_100_b031d18b-f935-40a6-8723-626d62e559eb already processed by broker, skipping
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: SimulatedBroker.process_order END
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - EVENT_EMIT: PORTFOLIO #3
2025-04-24 22:55:58,732 - DEBUG - [src.core.events.event_bus] - Emitting PORTFOLIO event (ID: a674d8b6-7b0d-477b-8506-8ae0f2669d5b)
2025-04-24 22:55:58,732 - INFO - [src.execution.order_manager] - Created order: Order(af5ac23c-bd9a-408b-96e1-0e75721c9bd4, AAPL, BUY, 100, PENDING)
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: OrderManager.on_order END
2025-04-24 22:55:58,732 - DEBUG - [src.execution.broker.broker_simulator] - Order b031d18b-f935-40a6-8723-626d62e559eb already processed by broker, skipping
2025-04-24 22:55:58,732 - INFO - [src.risk.managers.simple] - Created order: BUY 100 AAPL @ 100.00
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: SimpleRiskManager.on_signal START
2025-04-24 22:55:58,732 - DEBUG - [src.risk.managers.simple] - Processing signal: 1 for AAPL at 100.00
2025-04-24 22:55:58,732 - DEBUG - [src.risk.managers.simple] - Skipping duplicate signal processing for AAPL_BUY_2025-04-24T22:55:58.732158
2025-04-24 22:55:58,732 - DEBUG - [DebugFlow] - CALL: SimpleRiskManager.on_signal END
2025-04-24 22:55:58,833 - INFO - [DebugFlow] - Injecting second signal (SELL)
2025-04-24 22:55:58,833 - DEBUG - [DebugFlow] - EVENT_EMIT: SIGNAL #2 for MSFT value=-1
2025-04-24 22:55:58,833 - DEBUG - [src.core.events.event_bus] - Emitting SIGNAL event (ID: 656f4f18-1c07-437c-ad16-e4202cd1c180)
2025-04-24 22:55:58,834 - DEBUG - [src.risk.managers.simple] - Processing signal: -1 for MSFT at 120.00
2025-04-24 22:55:58,834 - DEBUG - [src.risk.managers.simple] - No position to sell for MSFT
2025-04-24 22:55:58,834 - DEBUG - [src.risk.managers.simple] - Signal for MSFT resulted in zero size, skipping
2025-04-24 22:55:58,834 - DEBUG - [DebugFlow] - CALL: SimpleRiskManager.on_signal START
2025-04-24 22:55:58,834 - DEBUG - [src.risk.managers.simple] - Processing signal: -1 for MSFT at 120.00
2025-04-24 22:55:58,834 - DEBUG - [src.risk.managers.simple] - No position to sell for MSFT
2025-04-24 22:55:58,834 - DEBUG - [src.risk.managers.simple] - Signal for MSFT resulted in zero size, skipping
2025-04-24 22:55:58,834 - DEBUG - [DebugFlow] - CALL: SimpleRiskManager.on_signal END
2025-04-24 22:55:58,935 - INFO - [DebugFlow] - === Event Summary ===
2025-04-24 22:55:58,935 - INFO - [DebugFlow] - Total events: 7
2025-04-24 22:55:58,935 - INFO - [DebugFlow] -   SIGNAL: 2
2025-04-24 22:55:58,935 - INFO - [DebugFlow] -   ORDER: 1
2025-04-24 22:55:58,935 - INFO - [DebugFlow] -   FILL: 1
2025-04-24 22:55:58,935 - INFO - [DebugFlow] -   OTHER: 3
2025-04-24 22:55:58,935 - INFO - [DebugFlow] - Portfolio cash: $90000.00
2025-04-24 22:55:58,936 - INFO - [DebugFlow] - Portfolio equity: $100000.00
2025-04-24 22:55:58,936 - INFO - [DebugFlow] - Orders created: 2
2025-04-24 22:55:58,936 - INFO - [DebugFlow] - Active orders: 2
2025-04-24 22:55:58,936 - INFO - [DebugFlow] - Order history: 0
2025-04-24 22:55:58,936 - INFO - [DebugFlow] - Event counts by type:
2025-04-24 22:55:58,936 - INFO - [DebugFlow] -   SIGNAL: 2
2025-04-24 22:55:58,936 - INFO - [DebugFlow] -   ORDER: 1
2025-04-24 22:55:58,936 - INFO - [DebugFlow] -   FILL: 1
2025-04-24 22:55:58,936 - INFO - [DebugFlow] -   PORTFOLIO: 3
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for REGIME garbage collected, cleaning up
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for FILTER garbage collected, cleaning up
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for OPTIMIZATION garbage collected, cleaning up
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for ERROR garbage collected, cleaning up
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for LIFECYCLE garbage collected, cleaning up
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for WEBSOCKET garbage collected, cleaning up
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for METRIC garbage collected, cleaning up
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for STRATEGY garbage collected, cleaning up
2025-04-24 22:55:58,936 - DEBUG - [src.core.events.event_bus] - Handler for PORTFOLIO garbage collected, cleaning up
2025-04-24 22:55:58,937 - DEBUG - [src.core.events.event_bus] - Handler for POSITION garbage collected, cleaning up
2025-04-24 22:55:58,937 - DEBUG - [src.core.events.event_bus] - Handler for FILL garbage collected, cleaning up
2025-04-24 22:55:58,937 - DEBUG - [src.core.events.event_bus] - Handler for ORDER garbage collected, cleaning up
2025-04-24 22:55:58,937 - DEBUG - [src.core.events.event_bus] - Handler for SIGNAL garbage collected, cleaning up
2025-04-24 22:55:58,937 - DEBUG - [src.core.events.event_bus] - Handler for BAR garbage collected, cleaning up
2025-04-24 22:55:58,937 - INFO - [DebugFlow] - Debug script completed successfully
